import 'package:powersync/powersync.dart';

const powerSyncSchema = Schema(
  [
    Table(
      'chats',
      [
        Column.text('last_message'),
        Column.text('updated_at'),
        Column.text('message_type'),
      ],
    ),
    Table(
      'chats_messages',
      [
        Column.text('created_at'),
        Column.integer('chat_id'),
        Column.text('message'),
        Column.text('message_type'),
        Column.integer('user_id'),
        Column.text('user_uuid'),
      ],
    ),
    Table(
      'chats_users',
      [
        Column.text('created_at'),
        Column.integer('chat_id'),
        Column.text('user_id'),
      ],
    ),
    Table(
      'profiles',
      [
        Column.text('created_at'),
        Column.text('user_id'),
        Column.text('username'),
      ],
    ),
    Table(
      'chat_summary',
      [
        Column.integer('chat_id'),
        Column.text('usernames'),
        Column.text('last_message'),
        Column.text('message_type'),
        Column.text('updated_at'),
        Column.text('user_ids'),
      ],
      indexes: [
        // Index to allow efficient lookup within a list
        Index(
          'chat_summary_user_ids',
          [
            IndexedColumn('user_ids'),
          ],
        ),
        Index(
          'chat_summary_usernames',
          [
            IndexedColumn('usernames'),
          ],
        ),
      ],
    ),
  ],
);
